<% if @export %>
	xlsxReportId = <%= "#{@export.id.to_s}" %>;

	<% if @export.generated? %>
		$j('#xlsx_download_button').html("Download is Ready");
		checkXlsxStatus = false;
		$j('#xlsx_download_button').removeClass('generating');
		$j('#xlsx_status').removeClass('generating');
		$j('#xlsx_download_button').removeClass('error');
		$j('#xlsx_status').removeClass('error');
		$j("#xlsx_status").html("Ready to download");

	<% elsif @export.generating? %>
		$j('#xlsx_download_button').html('<%= "#{h(@export.status.to_s.titleize)}..." %>');
		$j('#xlsx_download_button').addClass('generating');
		$j('#xlsx_status').addClass('generating');
		$j('#xlsx_download_button').removeClass('error');
		$j('#xlsx_status').removeClass('error');
		checkXlsxStatus = true;
		<% msg = "Your Excel file is being generated, which may take quite awhile. "
		msg << "You can leave this page and come back later to download the file. "
		msg << content_tag(:em, "(#{number_to_human_size(File.size(@export.file_path))})", :id => 'xlsx_filesize') if File.exist?(@export.file_path.to_s) %>
		$j("#xlsx_status").html('<%= msg %>');

	<% elsif @export.error? %>
		$j('#xlsx_download_button').html("Download in Excel");
		checkXlsxStatus = false;
	  $j('#xlsx_download_button').removeClass('generating');
		$j('#xlsx_status').removeClass('generating');
		$j('#xlsx_download_button').addClass('error');
		$j('#xlsx_status').addClass('error');
		$j("#xlsx_status").html("There was an error generating the file. Please try again.");

	<% else %>
		checkXlsxStatus = true;

	<% end %>
<% end %>
