$("#participants_table")
  .removeClass("loading")
  .attr("data-report", "<%= @report %>")
  .addClass("<%= @report %>")
  .append("<%=j render(:partial => 'participant', :collection => @participants, :locals => { :report => h(@report || 'basic') }) %>")

updateLoadProgress("<%= number_to_percentage(params[:page].to_f / @participants.total_pages.to_i * 100) %>")

history.pushState({'report' : '<%= @report %>'}, '<%= @report.titleize %>', '?report=<%= @report %>')

$("#export_actions").html("<%=j render('export_actions') %>")
exportReportType = "<%=j params[:report] %>"

if (typeof attendanceEventIds !== 'undefined') {
  buildAttendanceTable(attendanceEventIds)
}

$("#stages_selector").html("<%=j render('stages') %>")
$("#stages_selector a[data-stage]").click(clickStageSelector)
updateFiltersWithLocationHash()
executeFilters()
updateRecordCount()
prepareSelectAll()
$('tr.participant .needs-followup-container > a').click(showFollowUpPanel);
registerTableSorters()




if ("<%=j @participants.next_page.to_s %>" && !stopLoading) {
  console.log("Fetching page <%=j @participants.next_page.to_s %>")
  $.ajax({ url: '<%=j url_for(:report => @report, :page => @participants.next_page) %>', dataType: 'script' });
} else {
  hideLoadProgress()
}