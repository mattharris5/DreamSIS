<% f.inputs do %>
	<%= f.input :name, :hint => "Leave blank if this is a regular high school visit." %>
	
	<%= f.input :location, :label => "High School/Location", :hint => "Leave blank if this is a program-wide event. Program-wide events show up on everyone's attendance sheets.", :collection => Location.all %>

	<%= f.input :location_text, :label => "Location Detail", :hint => "Specify the location here if the event is happening at a location that's not in the list, or if you want to add extra location information, like room number." %>
	
	<%= f.input :event_type %>
	<%= f.input :event_group %>
	
	<%= f.input :date %>
	
	<%= f.input :time_tba, :label => "Time TBA", :input_html => { :onChange => "
					if($('event_time_tba').checked) {
						$('event_start_time_input').hide(); $('event_end_time_input').hide()
					} else {
						$('event_start_time_input').show(); $('event_end_time_input').show()
					}
				"} %>

	<%= f.input :start_time, :as => :string, :input_html => { :value => f.object.try(:start_time).try(:to_s, :time12), :size => 10 } %>
	<%= f.input :end_time, :as => :string, :input_html => { :value => f.object.try(:end_time).try(:to_s, :time12), :size => 10 } %>

	<%= javascript_tag "$('event_time_tba').onchange()" %>
	
	<%= f.input :description, :input_html => { :rows => 3 }, :hint => "Use #{link_to("Textile", "http://redcloth.org/", :popup => true)} markup for formatting." %>
	<%= f.input :capacity, :hint => "Leave capacity blank or 0 for no limit.", :input_html => {:size => 3} %>
	
	<li class="input">
		<%= f.label :event_coordinator_id %>
		
		<div>
			<%= model_auto_completer "person[fullname]", (@event.try(:event_coordinator).try(:fullname) if @event.try(:event_coordinator)), 
									"event[event_coordinator_id]", 
									(@event.try(:event_coordinator_id) || nil), 
									{ 
										:url => { :controller => 'events', :action => 'auto_complete_model_for_person_fullname' },
										:append_random_suffix => false,
										:after_update_element => "function(text_field, selection, hidden, id) { 
																	person_lookup(text_field, selection, hidden, id) 
																  }",
										:regexp_for_id => '(-?\d+)$' },
									{ :autocomplete => false, :style => ('display:none' if @event.try(:event_coordinator)), :size => 50 },
									{ :skip_style => true } %>
			
			<% javascript_tag do -%>	
				function person_lookup(text_field, selection, hidden, id) {
					Element.update('event_coordinator_details_content', selection.innerHTML)
					Element.show('event_coordinator_details')
					Element.hide(text_field)
				}
			<% end -%>

			<div id="event_coordinator_details" class="auto_complete after_select" <%= "style='display:none'" unless @event.try(:event_coordinator) %>>
				<div id="event_coordinator_details_content">
					<% if @event.try(:event_coordinator) %>
						<span class="primary"><%= @event.event_coordinator.fullname %>
						<small class="light">(#<%= @event.event_coordinator_id %>)</small></span>
						<span class="secondary"><%= @event.event_coordinator.email || "(no email)" %></span>
						<span class="tertiary"><%= @event.event_coordinator.class.to_s %></span>
					<% end -%>
				</div>
				<small><%= link_to_function "Change to a different person", 
										"Element.show('event_coordinator_details');
										 Element.show('model_auto_completer_tf');
										 $('model_auto_completer_tf').value = '';
										 $('model_auto_completer_tf').focus()" %></small>

			</div>
		</div>
	</li>

<% end -%>

<% f.inputs(:name => "Attendees") do %>
	<%= f.input :allow_rsvps, :label => "Allow people to RSVP before this event" %>
	<%= f.input :show_for_participants, :label => "Show on participant attendance sheets" %>
	<%= f.input :show_for_mentors, :label => "Show on mentor attendance sheets" %>
<% end -%>