<% 
participants ||= @participants
active_participants = participants.select{|p| !p.inactive? }
hide_title ||= false

 %>

<%- unless hide_title -%>
	<h2><%= Participant.current_cohort %> Participants</h2>
<% end -%>

<table class="stats">

	<tr>
		<td class="title">Total Students</td>
		<td class="number"><%= participants.size %></td>
		<td></td>
		<td class="percentage"></td>
	</tr>
	
	<tr>
		<td class="title">Active Students</td>
		<td class="number"><%= active_participants.size %></td>
		<td></td>
		<td class="percentage"><%= number_to_percentage(active_participants.size.to_f / participants.size.to_f * 100, :precision => 0) rescue 0.0/0.0 %></td>
	</tr>
	
	<% for object_filter in Participant.object_filters %>
		<% 
		filtered_participants = active_participants.select{|p| object_filter.passes?(p)} 
		my_percentage = filtered_participants.size.to_f / active_participants.size.to_f * 100
		%>
		<tr>
			<td class="title"><%= object_filter.title %></td>
			<td class="number"><%= filtered_participants.size %></td>
			<td class="percentage-meter" style="min-width:3em;"><div class="signup-meter">
					<div class="capacity" style="width: 100%;" title="<%= number_to_percentage my_percentage, :precision => 0 %>">
						<div class="size" style="width: <%= my_percentage %>%">
							<%#= mentor_quarter_group.full? ? content_tag(:span, "full", :class => "full_label") : "&nbsp;" %>
							&nbsp;
						</div>
					</div>
				</div>
				</td>
			<td class="percentage signup-numbers"><%= number_to_percentage(my_percentage, :precision => 0) rescue 0.0/0.0 %>
		</tr>
	<% end -%>
	
</table>

<small class="light">Counts and percentages above are compared against <strong>active</strong> participants only.</small>